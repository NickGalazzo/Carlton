@using Carlton.Base.Client.Components.Tree
@using Carlton.TestBed.TestBedNavTree
 
<div class="carlton-test-bed-nav-tree">
    <img src="https://paradisebound.org/wp-content/uploads/2016/09/paradise-bound-ministries-mission-teams-homes-built-and-dedicated-house-icon.png" height="50" width="50" alt="Image result for house icon" />
    <span>Carlton TestBed</span>

    <BaseTree Nodes="ViewModel"
              ChildSelector="@(item => item.Children)"
              @bind-SelectedNode="SelectedNode"
              @bind-ExpandedNodes="ExpandedNodes"
              HasChildNodes="@(item => item.Children?.Any() == true)"
              Style="TreeStyle.DefaultTreeStyle">
        <TitleTemplate>@context.DisplayName</TitleTemplate>
    </BaseTree>
</div>


@code {
    [Parameter]
    public IEnumerable<TestBadNavTreeItem> ViewModel { get; set; }

    [Parameter]
    public EventCallback<TestBadNavTreeItem> SelectedItemChanged { get; set; }

    [Parameter]
    public TestBadNavTreeItem InitialSelection { get; set; }

    protected override void OnInitialized()
    {
        base.OnInitialized();
        SelectedNode = InitialSelection;
    }

    IList<TestBadNavTreeItem> ExpandedNodes = new List<TestBadNavTreeItem>();

    private TestBadNavTreeItem _selectedNode;
    private TestBadNavTreeItem SelectedNode
    {
        set
        {
            _selectedNode = value;
            SelectedItemChanged.InvokeAsync(value);
        }
        get
        {
            return _selectedNode;
        }
    }
}
